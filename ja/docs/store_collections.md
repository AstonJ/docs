# Store Collection

ストアコレクションは、データストアにデータを保存するためのものです。現在サポートされているデータストアはMongoのみです。(他のものも検討中です。おそらく次はRethinkDBに対応するでしょう) ストアは他のコレクションとほとんど同じように利用することができます。

Volt ではフロントエンドとバックエンドのどちらでも ```store``` にアクセスすることができます。そして、フロントエンドとバックエンドでデータが自動的に同期されます。ストアされているデータに対する変更はすべて、そのデータを利用中のすべてのクライアントに対して反映されます。(ただし、後述の [buffer](#buffer) が使われている場合は除きます。)

```ruby
    store._items << {_name: 'Item 1'}

    store._items[0]
    # => <Volt::Model:70303681865560 {:name=>"Item 1", :_id=>"e6029396916ed3a4fde84605"}>
```

```sore_items``` へ挿入を行うと、```_items``` テーブルが作成され、そこにモデルが格納されます。そのとき、仮の一意な _id が自動的に生成されます。

現在、```store``` とそれ以外のコレクションで異なっている点は、```store``` はプロパティを直接持つことができないことです。```store``` に直接設定することができるのは ArrayModel のみとなっています。

```ruby
    store._something = 'yes'
    # => won't be saved at the moment
```

メモ: ```store``` に直接プロパティを設定できるようにすることも検討中です。

## モデルの状態の保存

サーバーとのデータの同期にはどうしても遅延があります。そこで、モデルが読み込まれたか、同期されたか、ということを判断するための ```state``` というメソッドをストアモデルは提供します。


| 状態        | 説明                                                         |
|-------------|--------------------------------------------------------------|
| not_loaded  | データは読み込まれていません                                 |
| loading     | モデルはサーバーからデータを取得中です                       |
| loaded      | データは読み込まれており、未同期のデータはありません         |
| dirty       | データは変更されていますが、まだサーバーへ同期されていません |
| inactive    | モデルは更新に対してリッスン状態ではありません||

inactive の状態は、モデルのどのイベントリスナーもバインディングもリスニング中ではない場合に発生します。
